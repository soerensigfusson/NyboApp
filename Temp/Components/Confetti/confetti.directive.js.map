{"version":3,"sources":["confetti.directive.js"],"names":["confettiDirective","$inject","angular","module","directive","$timeout","restrict","templateUrl","link","scope","duration","element","attr","canvas","ctx","W","H","mp","particles","angle","tiltAngle","confettiActive","animationComplete","deactivationTimerHandler","reactivationTimerHandler","animationHandler","particleColors","colorOptions","colorIndex","colorIncrementer","getColor","length","confettiParticle","color","x","Math","random","y","r","RandomFromTo","d","tilt","floor","tiltAngleIncremental","draw","beginPath","lineWidth","strokeStyle","moveTo","lineTo","stroke","SetGlobals","document","querySelectorAll","getContext","window","innerWidth","innerHeight","width","height","InitializeConfetti","i","particleColor","push","StartConfetti","Draw","clearRect","results","j","Update","from","to","remainingFlakes","particle","stepParticle","CheckForReposition","StopConfetti","index","repositionParticle","sin","particleIndex","cos","xCoordinate","yCoordinate","animloop","requestAnimFrame","ClearTimers","clearTimeout","DeactivateConfetti","undefined","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","ready"],"mappings":"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","file":"confetti.directive.js","sourcesContent":["(function() {\n\n    confettiDirective.$inject = [\"$timeout\"];\n    angular.module('App.Components.Confetti', ['app.templates'])\n        .directive('confetti', confettiDirective);\n\n\n    function /*@ngInject*/ confettiDirective($timeout) {\n\n        var directive = {\n            restrict: 'E',\n            templateUrl: 'Components/Confetti/confetti.tpl.html',\n            link: link,\n            scope: {\n            \tduration: '@'\n            }\n        };\n\n        function link(scope, element, attr) {\n\n        \tscope.duration = scope.duration || 800;\n\n\t\t\t//@see http://jsfiddle.net/Javalsu/vxP5q/743/?utm_source=website&utm_medium=embed&utm_campaign=vxP5q\n\n            // globals\n            var canvas;\n            var ctx;\n            var W;\n            var H;\n            var mp = 100; //max particles\n            var particles = [];\n            var angle = 0;\n            var tiltAngle = 0;\n            var confettiActive = true;\n            var animationComplete = true;\n            var deactivationTimerHandler;\n            var reactivationTimerHandler;\n            var animationHandler;\n\n            // objects\n\n            var particleColors = {\n                colorOptions: [\n                \t//Nordea colors\n\t\t\t\t\t'#3AC1A3',\n\t\t\t\t\t'#FFE27C',\n\t\t\t\t\t'#FF5757',\n\t\t\t\t\t'#97CDFF',\n\t\t\t\t\t'#2C97FF',\n\t\t\t\t\t'#0000FF'\n            \t],\n\n                colorIndex: 0,\n                colorIncrementer: 0,\n\n                getColor: function() {\n                    if (this.colorIncrementer >= 10) {\n                        this.colorIncrementer = 0;\n                        this.colorIndex++;\n                        if (this.colorIndex >= this.colorOptions.length) {\n                            this.colorIndex = 0;\n                        }\n                    }\n                    this.colorIncrementer++;\n                    return this.colorOptions[this.colorIndex];\n                }\n            };\n\n            function confettiParticle(color) {\n\n                this.x = Math.random() * W; // x-coordinate\n                this.y = (Math.random() * H) - H; //y-coordinate\n                this.r = RandomFromTo(10, 30); //radius;\n                this.d = (Math.random() * mp) + 10; //density;\n                this.color = color;\n                this.tilt = Math.floor(Math.random() * 10) - 10;\n                this.tiltAngleIncremental = (Math.random() * 0.07) + .05;\n                this.tiltAngle = 0;\n\n                this.draw = function() {\n                    ctx.beginPath();\n                    ctx.lineWidth = this.r / 2;\n                    ctx.strokeStyle = this.color;\n                    ctx.moveTo(this.x + this.tilt + (this.r / 4), this.y);\n                    ctx.lineTo(this.x + this.tilt, this.y + this.tilt + (this.r / 4));\n                    return ctx.stroke();\n                };\n            }\n\n            function SetGlobals() {\n                canvas = document.querySelectorAll('.confetti')[0];\n                ctx = canvas.getContext(\"2d\");\n                W = window.innerWidth;\n                H = window.innerHeight;\n                canvas.width = W;\n                canvas.height = H;\n            }\n\n            function InitializeConfetti() {\n                particles = [];\n                animationComplete = false;\n                for (var i = 0; i < mp; i++) {\n                    var particleColor = particleColors.getColor();\n                    particles.push(new confettiParticle(particleColor));\n                }\n                StartConfetti();\n            }\n\n            function Draw() {\n                ctx.clearRect(0, 0, W, H);\n                var results = [];\n                for (var i = 0; i < mp; i++) {\n                    (function(j) {\n                        results.push(particles[j].draw());\n                    })(i);\n                }\n                Update();\n\n                return results;\n            }\n\n            function RandomFromTo(from, to) {\n                return Math.floor(Math.random() * (to - from + 1) + from);\n            }\n\n\n            function Update() {\n                var remainingFlakes = 0;\n                var particle;\n                angle += 0.01;\n                tiltAngle += 0.1;\n\n                for (var i = 0; i < mp; i++) {\n                    particle = particles[i];\n                    if (animationComplete) return;\n\n                    if (!confettiActive && particle.y < -15) {\n                        particle.y = H + 100;\n                        continue;\n                    }\n\n                    stepParticle(particle, i);\n\n                    if (particle.y <= H) {\n                        remainingFlakes++;\n                    }\n                    CheckForReposition(particle, i);\n                }\n\n                if (remainingFlakes === 0) {\n                    StopConfetti();\n                }\n            }\n\n            function CheckForReposition(particle, index) {\n                if ((particle.x > W + 20 || particle.x < -20 || particle.y > H) && confettiActive) {\n                    if (index % 5 > 0 || index % 2 == 0) //66.67% of the flakes\n                    {\n                        repositionParticle(particle, Math.random() * W, -10, Math.floor(Math.random() * 10) - 10);\n                    } else {\n                        if (Math.sin(angle) > 0) {\n                            //Enter from the left\n                            repositionParticle(particle, -5, Math.random() * H, Math.floor(Math.random() * 10) - 10);\n                        } else {\n                            //Enter from the right\n                            repositionParticle(particle, W + 5, Math.random() * H, Math.floor(Math.random() * 10) - 10);\n                        }\n                    }\n                }\n            }\n\n            function stepParticle(particle, particleIndex) {\n                particle.tiltAngle += particle.tiltAngleIncremental;\n                particle.y += (Math.cos(angle + particle.d) + 3 + particle.r / 2) / 2;\n                particle.x += Math.sin(angle);\n                particle.tilt = (Math.sin(particle.tiltAngle - (particleIndex / 3))) * 15;\n            }\n\n            function repositionParticle(particle, xCoordinate, yCoordinate, tilt) {\n                particle.x = xCoordinate;\n                particle.y = yCoordinate;\n                particle.tilt = tilt;\n            }\n\n            function StartConfetti() {\n                W = window.innerWidth;\n                H = window.innerHeight;\n                canvas.width = W;\n                canvas.height = H;\n                (function animloop() {\n                    if (animationComplete) return null;\n                    animationHandler = requestAnimFrame(animloop);\n                    return Draw();\n                })();\n            }\n\n            function ClearTimers() {\n                clearTimeout(reactivationTimerHandler);\n                clearTimeout(animationHandler);\n            }\n\n            //Deactivates confetti and lets it drift out of the screen\n            function DeactivateConfetti() {\n                confettiActive = false;\n                ClearTimers();\n            }\n\n            /**\n            * Stops confetti and removes it\n            */\n            function StopConfetti() {\n                animationComplete = true;\n                if (ctx === undefined) {\n                \treturn;\n                }\n                ctx.clearRect(0, 0, W, H);\n            }\n\n            window.requestAnimFrame = (function() {\n                return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(callback) {\n                    return window.setTimeout(callback, 1000 / 60);\n                };\n            })();\n\n            //Kick start the party!\n            angular.element(document).ready(function() {\n\n                SetGlobals();\n                InitializeConfetti();\n\n                $timeout(function() {\n                \tDeactivateConfetti();\n                }, scope.duration);\n\n            });\n\n        }\n\n        return directive;\n    }\n\n})();\n"]}